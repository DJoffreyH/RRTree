### 任务：编写一个带约束的函数

**背景：**
你需要编写一个健壮的Python函数，用于处理用户配置数据。这个函数需要接收一个字典作为输入，并返回一个经过验证和清理的字典。

**要求：**
请编写一个名为 `process_user_config` 的Python函数，该函数接收一个名为 `config` 的字典，并必须严格遵守以下所有约束：

1.  **函数签名：** 函数签名必须是 `def process_user_config(config: dict) -> dict:`。
2.  **输入验证：**
    *   如果输入的 `config` 不是一个字典，函数必须抛出 `TypeError`。
3.  **字段处理规则：**
    *   **`username` (str):** 必须存在。如果缺失，抛出 `ValueError`。值必须被转换为全小写。
    *   **`theme` (str):** 可选字段。如果存在，其值必须是 `'light'`, `'dark'`, 或 `'system'` 之一。如果不是，将其值重置为默认值 `'system'`。
    *   **`notifications_enabled` (bool):** 可选字段。如果缺失，默认为 `True`。如果存在但不是布尔值，也应将其值设为 `True`。
    *   **`max_items_per_page` (int):** 可选字段。如果存在，其值必须在10到100之间（包含边界）。如果超出范围，将其值强制设为 `50`。
4.  **未知字段：** 函数返回的字典中，**必须移除**任何不在上述规则中定义的未知字段。
5.  **返回值：** 函数必须返回一个新的字典，不能修改原始输入的字典对象。